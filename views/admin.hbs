<html>

<head>
    <script src="jquery.min.js"> </script>
    <script>
        $(document).ready(function () {
            //TODO: Put script for update
            $("button.edit").click(function () {
                $("#editid").val($(this).attr("data-id"));
                $("#editform").submit();
            })

            $("button.delete").click(function () {
                /*console.log("button.delete");
                $("deleteid").val($(this).attr("data-id"));
                ("deleteform").submit()*/
                let id = $(this).attr("data-id");
                $.ajax({
                    url : "delete",
                    method : "POST" ,
                    data : {
                        id: $(this).attr("data-id")
                    },
                    success: function(result){
                        console.log(result);
                        if(result.ok==1) {
                            console.log("tr[data-id='" + id + "']");
                            alert("Successfully deleted");
                            $("tr[data-id='" + id + "']").remove();
                        }
                        else {
                            alert("Something went wrong");
                        }
                    }

                })
            })

            //TODO: Put script for delete

        })


    </script>

</head>

<body>

    <form action="add" method="POST">
        Username<input type="text" name="user"> <br>
        Password <input type="text" name="pass"> <br>
        <input type="submit" value="add">
    </form>

    <table>
        {{#each users}}
        <tr>
            <td>{{username}}</td>
            <td> {{password}}</td>

            <td>
                <button class="edit" data-id="{{_id}}"> edit </button>
            </td>

            <td>
                <button class="delete" data-id="{{_id}}"> delete </button>
            </td>

        </tr>
        {{/each}}
    </table>

    <form action="edit" id="editform">
        <input type="hidden" name="id" id="editid">
    </form>

    <form action="delete" id="deleteform">
        <input type="hidden" name="id" id="deleteid">
    </form>
</body>

</html>